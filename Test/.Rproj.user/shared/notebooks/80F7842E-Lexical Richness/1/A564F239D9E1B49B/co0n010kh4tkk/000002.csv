"0",".cleanup <- function(filepath, stopwords = c(), normalize = TRUE) {"
"0","  stopwords <- scan(""/Users/yuchenlu/Desktop/Reconstructing_London/stopwords.txt"", what="""", sep=""\n"")"
"0",""
"0","  if (length(grep("".txt"",filepath)) == 1) {"
"0","    text = scan(filepath,what=""character"",sep=""\n"", fileEncoding = ""UTF-8"")"
"0","    text = paste(text, collapse= "" "")"
"0","    "
"0","  } else if (length(grep("".xml"",filepath)) == 1) {"
"0","    parsedText = htmlTreeParse(filepath,useInternalNodes = TRUE)"
"0","    nodes = getNodeSet(parsedText,""//text"")"
"0","    text = lapply(nodes,xmlValue)"
"0","  }"
"0","  "
"0","  text = gsub(""non-Latin alphabet"", "" "", text)"
"0","  text = gsub(""1 page duplicate"", "" "", text)"
"0","  "
"0","  if (normalize == TRUE) {"
"0","    text = gsub(""ſ"", ""s"", text)"
"0","    #text = gsub(""?.¿"", ""s"", text)"
"0","    text = gsub(""[0-9]"", """", text)"
"0","    text = gsub(""vv"", ""w"", text)"
"0","    text = gsub(""'d "", ""ed "", text)"
"0","    text = gsub(""'ring "", ""ering "", text)"
"0","  }"
"0","  "
"0","  text = strsplit(text,""\\W"")"
"0","  text = unlist(text)"
"0","  text = text[text!=""""]"
"0","  "
"0","  if (normalize == TRUE) {"
"0","    text = tolower(text)"
"0","    text = text[text %in% stopwords == FALSE]"
"0","    if (any(grep(""[^\x20-\x7E]"",text))) text = text[-grep(""[^\x20-\x7E]"",text)]"
"0","  }"
"0","  "
"0","  text = paste(text, collapse = "" "")"
"0","  return(text)"
"0","}"
